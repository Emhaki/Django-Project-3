{% extends 'base.html' %}
{% load static %}

{% load django_bootstrap5 %}
{% block content %}
<div class="login-frame">
  <div class="login-frame__form">
    <img class="login-frame__form__img" src="{% static 'images/nes_orange.png' %}" alt="">
    <form id="login-form">
      {% csrf_token %}
      <input class="login-frame__form__id" type="text" name="username" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.">
      <input class="login-frame__form__password" type="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.">
      <button class="login-frame__form__logbtn">ë¡œê·¸ì¸</button>
    </form>
    <a href="{% url 'accounts:kakao' %}">
      <button class="login-frame__form__googlebtn">ğŸ³ CONTINUE WITH KAKAO</button>
    </a>
    <div class="login-frame__form__detail">
      <div class="login-frame_-form__detail__find">
        <a href="">ì•„ì´ë”” ì°¾ê¸°</a>
        |
        <a href="">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
      </div>
      <div class="login-frame__form__detail__signup">
        <a href="{% url 'accounts:signup'%}">íšŒì›ê°€ì…</a>
      </div>
    </div>
  </div>
</div>
<script>
  const loginForm = document.querySelector("#login-form");
  loginForm.addEventListener("submit", function (event) {
    event.preventDefault();
    axios({
      method: "post",
      url: `/accounts/login/`,
      data: new FormData(loginForm)
    })
      .then(response => {
        let msg = response.data.errorMsg;
        if (msg) {
          if (msg === "ì˜ëª»ëœ ì•„ì´ë”” í˜¹ì€ íŒ¨ìŠ¤ì›Œë“œ ì…ë‹ˆë‹¤.") {
            let titleText = "ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤."
            let iconText = "error"
            swal.fire({
              backdrop: "rgba(255,255,255,0.5)",
              confirmButtonColor: '#203e96',
              confirmButtonText: 'ë‹«ê¸°',
              title: titleText,
              text: msg,
              icon: iconText,
            });
          } else if (msg === "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íšŒì›ì…ë‹ˆë‹¤.") {
            let titleText = "ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
            let iconText = "question"
            swal.fire({
              backdrop: "rgba(255,255,255,0.5)",
              confirmButtonColor: '#203e96',
              confirmButtonText: 'ë‹«ê¸°',
              title: titleText,
              text: msg,
              icon: iconText,
            });
          };
          loginForm.reset();
        } else {
          window.location.href = "{% url 'articles:ticket_machine' %}";
        };
      });
  });
</script>
{% endblock content %}